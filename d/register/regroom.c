// Room:/d/welcome/regroom.c
// Updated by Lonely (08/11/2002)

#include <ansi.h>
inherit ROOM;
int do_register(string arg);

void create()
{
        set("short", "æ³¥æ½­æ³¨å†Œå®¤");
        set("long", "\nè¿™é‡Œæ˜¯æ–°ç©å®¶è¿›è¡Œæ³¨å†Œçš„åœ°æ–¹ï¼Œè¯·æ‚¨ä½¿ç”¨æŒ‡ä»¤ " HIC "register " NOR "åŠ ä¸Šä½ çš„å®Œ\n"
                    "æ•´åŠçœŸå®" HIC " email " NOR "åœ°å€è¿›è¡Œæ³¨å†Œã€‚\n\n"
                    "    è¯·åŠ¡å¿…è®¤çœŸæ³¨å†Œä½ çš„ç”µå­é‚®ä»¶åœ°å€ï¼Œ" HIR "ç”µå­é‚®ä»¶åœ°å€æ˜¯ä¿éšœä½ ä¸€åˆ‡\n"
                    "æƒç›Šçš„ä¾æ®" NOR "ï¼ŒåŒ…æ‹¬ä½ å¯†ç çš„ä¸¢å¤±æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡ä½ æ³¨å†Œçš„ä¿¡ç®±æ¥ç¡®\n"
                    "è®¤ä½ çš„èº«ä»½å’Œå½’è¿˜ä½ çš„å¯†ç ã€‚\n\n"

                    "ç°åœ¨ï¼Œè¯·è¾“å…¥" HIW " reg æ‚¨çš„emailåœ°å€\n\n" NOR);


        set("item_desc", ([
        "sign":
"\t     [1;33mæœ‰å…³ç”µå­é‚®ä»¶æ³¨å†Œçš„å‡ ç‚¹è¯´æ˜[0m
[37mï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼[0m
é¦–å…ˆè¯·ä½ ä»”ç»†æ£€æŸ¥æ³¨å†Œå‘½ä»¤é‡Œè¾“å…¥çš„ç”µå­é‚®ä»¶åœ°å€æ˜¯å¦æ­£ç¡®ï¼

è¿™ä¸ªæ¸¸æˆçš„æ³¨å†Œè¿‡ç¨‹æ˜¯ç”±æœºå™¨è‡ªåŠ¨å®Œæˆçš„ï¼Œåœ¨ä½ è¿˜æ²¡æœ‰ç¦»å¼€
æ¸¸æˆçš„æ—¶å€™æ³¨å†Œä¿¡å°±å·²ç»å‘å‡ºäº†ã€‚å¦‚æœæ³¨å†Œä¿¡æœªèƒ½æ­£ç¡®å‘å‡º
ä¼šæç¤ºä½ ä»æ–°è¾“å…¥æ³¨å†Œå‘½ä»¤ï¼Œåªæœ‰æ­£ç¡®å‘å‡ºä»¥åæ‰ä¼šå°†æ³¨å†Œ
ç©å®¶æ–­çº¿ã€‚
ä½ æ”¶åˆ°çš„æ—¶é—´æ˜¯æœ‰ä½ çš„é‚®ä»¶æœåŠ¡æä¾›è€…å†³å®šçš„ï¼Œå¦‚æœä»–ä»¬è½¬
ä¿¡çš„æ—¶é—´å¿«ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä½ åº”å½“åœ¨[1;33m10[0mç§’é’Ÿä¹‹å†…æ”¶åˆ°ã€‚ä¹Ÿå°±æ˜¯
ä½ å…³ä¸Š zMudçª—å£æ‰“å¼€é‚®ä»¶ç¨‹åºï¼Œå°±åº”å½“èƒ½æ”¶åˆ°äº†ã€‚æœ€è¿Ÿ[1;33m1-2[0m
ä¸ªå°æ—¶ä¹Ÿåº”å½“æ”¶åˆ°ã€‚
æˆ‘ä»¬çš„æ¸¸æˆç»™ç©å®¶ç•™äº† [1;36m48[0m ä¸ªå°æ—¶çš„æ”¶ä¿¡æ—¶é—´åº”å½“æ˜¯å¾ˆå……åˆ†
çš„ã€‚å¦‚æœåœ¨è¿™æ®µæ—¶é—´å†…è¿˜æœªèƒ½æ”¶åˆ°æˆ‘ä»¬å‘ç»™ä½ çš„ä¿¡ï¼Œå»ºè®®ä½ 
æ¢ä¸€ä¸ªè½¬ä¿¡å¿«çš„é‚®ä»¶æœåŠ¡æä¾›è€…å†æ¬¡ç”³è¯·ï¼Œæˆ–è€…å‘ä½ çš„é‚®ä»¶
æœåŠ¡æä¾›è€…è¿›è¡Œå’¨è¯¢ã€‚

æ„Ÿè°¢ä½ å¯¹è¿™ä¸ªæ¸¸æˆçš„å…³æ³¨ã€‚  (æ³¨ï¼šé‚®ä»¶æ³¨å†Œåˆ¶åº¦æš‚ç¼“å®è¡Œ)
[37mï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼[0m
                               \t\t[1;36m" + MUD_NAME + "å·«å¸ˆç»„[0m\n"
        ]));


        set("no_fight", 1);
        set("no_magic", 1);
        set("no_steal", 1);
        set("no_beg", 1);   
        // set("valid_startroom", 1); 
     
        setup();
}

void init()
{
        add_action("do_register", "register");
        add_action("do_register", "reg");
        add_action("do_register", "zhuce");
}

int do_register(string arg)
{
        object me = this_player();
        string mail;
        string msg;
        
        if (! arg|| strsrch(arg, "@") == -1 
        || sscanf(arg, "%*s@%*s.%*s") != 3 
        || strsrch(arg, ",") != -1)
                return notify_fail("ç”µå­é‚®ä»¶åœ°å€å¿…é¡»æ˜¯ "
                                   "player@me.com æ ¼å¼ã€‚\n");
        else
        {
                mail = arg;
                set("email", mail, me);

                msg=query("name", me)+"ï¼ˆ"+query("id", me)+"ï¼‰ï¼š\n\n";

                msg += "    æ¬¢è¿è¿›å…¥æ³¥æ½­çš„ä¸–ç•Œï¼Œä»è¿™ä¸€åˆ»èµ·æ‚¨å°†æœ‰æœºä¼šä½“éªŒåˆ°å…¶ä»–MUD æ— \n" +
                       "æ³•å¸¦ç»™æ‚¨çš„å¿«ä¹ã€‚\n";
                msg += "    å¦‚æœæ‚¨æ˜¯ä¸€ä¸ªå–œæ¬¢èŠå¤©çš„äººï¼Œè¿™é‡Œæœ‰æ›´å¤šï¼Œæ›´æœ‰è¶£ï¼Œä¹Ÿæ›´å…¨é¢çš„\n" +
                       "emote å¯ä»¥è®©æ‚¨å°½æƒ…äº«ä¹ï¼Œå¬‰ç¬‘æ€’éª‚ï¼Œå®Œå…¨ä¸å¿…è´Ÿè´£ä»»ã€‚\n";
                msg += "    å¦‚æœæ‚¨æ˜¯ä¸€ä¸ªå–œæ¬¢ç»ƒåŠŸçš„äººï¼Œè¿™é‡Œçš„é—¨æ´¾ä¹‹é—´å°†è¾¾åˆ°æœ€å¤§é™åº¦çš„\n" +
                       "å¹³è¡¡ï¼Œå¤šæ ·çš„ä»»åŠ¡ç³»ç»Ÿå¯ä»¥è®©æ‚¨æ¯”è¾ƒé¡ºåˆ©çš„æˆå°±ä¸€ä»£å®—å¸ˆã€‚\n";
                msg += "    å¦‚æœå¾ˆä¸å·§çš„æ‚¨æ˜¯ä¸€ä¸ªåˆ©æ¬²ç†å¿ƒçš„äººï¼Œè¿™é‡Œçš„å®˜èŒç³»ç»Ÿä¸€å®šå¯ä»¥\n" +
                       "æ»¡è¶³æ‚¨æ‹…å½“å…µé©¬å¤§å°†å†›çš„æ¬²æœ›ã€‚\n";
                msg += "    å¦‚æœæ‚¨æ˜¯ä¸€ä¸ªæ¸´æœ›ç”Ÿæ´»çš„äººï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œå¨¶å¦»ç”Ÿå­ï¼Œä¹°æˆ¿é’“é±¼\n" +
                       "ä¸ºä¹ï¼Œäº«å—é‚£ä¸€ä»½ä¸–å¤–é«˜äººçš„æ¬é™ä¸æ·¡é›…ã€‚\n";
                msg += "    å¦‚æœæ‚¨å¯¹MUD æ¸¸æˆæ„Ÿåˆ°å¾ˆé™Œç”Ÿï¼Œæˆ‘ä»¬çš„æ³¥æ½­ä¸­æœ‰å®Œå–„çš„æ–°æ‰‹æŒ‡å¼•\n" +
                       "ç³»ç»Ÿï¼Œå¹¶è®¾æœ‰ä¸“é—¨çš„æ–°äººå¯¼å¸ˆå¯¹å„ä½æ–°ç©å®¶è¿›è¡ŒæŒ‡å¯¼ã€‚\n";
                msg += "    åŒæ—¶ï¼Œè¿™é‡Œä¸¥æ ¼è´¯å½»â€œå…¬å¹³ï¼Œå…¬æ­£ï¼Œå…¬å¼€â€å…­å­—çœŸè¨€ï¼ŒåŠªåŠ›ä¸ºå„\n" +
                       "ä½ç©å®¶æ‰“é€ ä¸€ç‰‡çº¯å‡€çš„æ¸¸æˆå¤©ç©ºã€‚\n";
                msg += "    æ›´å¤šçš„æ¸¸æˆç‰¹è‰²æ‚¨å¯ä»¥è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™www.chinesemud.orgï¼Œæˆ–\n" +
                       "è€…ç›´æ¥è¿›å…¥æ¸¸æˆå†…éƒ¨ç”¨helpå‘½ä»¤è¿›è¡ŒæŸ¥è¯¢ã€‚å¦‚æœæ‚¨å¯¹æˆ‘ä»¬çš„æ¸¸æˆæœ‰ä»»\n" +
                       "ä½•æ„è§ï¼Œæ‚¨å¯ä»¥åœ¨æ¸¸æˆå†…éƒ¨çš„ç•™è¨€æ¿ä¸Šç•™è¨€ï¼Œæˆ–è€…ç›´æ¥ç™»é™†æˆ‘ä»¬çš„è®º\n" +
                       "å›bbs.chinesemud.orgã€‚\n";
                msg += "    å†æ¬¡è¡·å¿ƒæ„Ÿè°¢æ‚¨å‚ä¸æˆ‘ä»¬çš„æ¸¸æˆï¼Œåœ¨æ­¤æ³¥æ½­çš„å·«å¸ˆä»¬å°†ä»¥æœ€å¤§çš„\n" +
                       "çƒ­æƒ…å›æŠ¥æ‚¨å¯¹æˆ‘ä»¬çš„æ”¯æŒã€‚\n";
                msg += "    è°¢è°¢ï¼\n\n";

                msg += "ã€€ã€€        ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€                æ³¥æ½­å·«å¸ˆå·¥ä½œç¾¤\n";

                /*
                if (! MAIL_D->queue_mail(me, "nitan@chinesemud.org",
                        query("email", me),"æ„Ÿè°¢æ‚¨å…‰ä¸´æ³¥æ½­ç½‘ç»œæ¸¸æˆ",msg) )
                {
                        tell_object(me, query_fail_msg());
                        tell_object(me, "å‘é€æ³¨å†Œé‚®ä»¶å¤±è´¥ï¼Œè¯·æ³¨å†Œä½ æ­£ç¡®çš„é‚®ä»¶åœ°å€ï¼\n");
                        return 1;
                }
                */
                
                set("registered", 1, me);
                /*
                tell_object(me, "\næœ‰ä¸€å°é‚®ä»¶å·²æ ¹æ®æ‚¨ç™»è®°çš„åœ°å€å‘å¾€\n\n" +
                                ""+HIW+query("email", me)+NOR+"\n\nè¯·æ‚¨"
                                HIG "äºŒåˆ†é’Ÿ" NOR "åæ£€æŸ¥æ‚¨çš„ç”µå­é‚®ä»¶ä¿¡ç®±ã€‚\n");
                */
                tell_object(me, HIR "\nç¥æ‚¨åœ¨æ³¥æ½­ç©çš„æ„‰å¿«ï¼:)\n\n" NOR);
                message("vision", "åªè§ç™½å…‰ä¸€é—ªï¼Œ"+me->name()+"æ¶ˆå¤±äº†ã€‚\n", environment(me), ({me}) ); 
                // SMTP_D->send_mail(me,mail);
                me->move("/d/register/entry");
                message("vision", "ä½ å¿½ç„¶å‘ç°å‰é¢å¤šäº†ä¸€ä¸ªäººå½±ã€‚\n", environment(me), me);
                
                return 1;
        }
}
